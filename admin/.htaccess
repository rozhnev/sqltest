<IfModule mod_rewrite.c>
    RewriteEngine On

    # Never expose Smarty source/compiled templates directly.
    RewriteRule ^(?:templates|templates_c)(?:/|$) - [F,L]

    # Keep admin PHP execution behind the single router entrypoint.
    RewriteCond %{REQUEST_URI} \.php$
    RewriteCond %{REQUEST_URI} !^/admin/index\.php(?:/.*)?$
    RewriteRule ^ - [F,L]
</IfModule>
