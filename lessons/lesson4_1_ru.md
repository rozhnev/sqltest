# Урок 4.1: Базовые агрегатные функции в SQL

Агрегатные функции в SQL используются для выполнения вычислений над несколькими строками столбца таблицы и возвращают одно итоговое значение. Эти функции необходимы для суммирования данных, создания отчетов и проведения статистического анализа. В этом уроке рассмотрены самые распространённые агрегатные функции с практическими примерами на базе данных Sakila.

## Основные агрегатные функции

### `COUNT()` — Считает количество строк

**Синтаксис:**
```sql
COUNT(expression)
```

**Пример:**
```sql
SELECT COUNT(*) AS total_payments
FROM payment;
```
**Результат:** Возвращает общее количество строк в таблице `payment`.

### `SUM()` — Вычисляет сумму значений

**Синтаксис:**
```sql
SUM(expression)
```

**Пример:**
```sql
SELECT SUM(amount) AS total_amount
FROM payment;
```
**Результат:** Возвращает сумму значений столбца `amount`.

### `AVG()` — Вычисляет среднее значение

**Синтаксис:**
```sql
AVG(expression)
```

**Пример:**
```sql
SELECT AVG(amount) AS average_amount
FROM payment;
```
**Результат:** Возвращает среднее значение столбца `amount`.

### `MIN()` — Находит минимальное значение

**Синтаксис:**
```sql
MIN(expression)
```

**Пример:**
```sql
SELECT MIN(amount) AS min_amount
FROM payment;
```
**Результат:** Возвращает наименьшее значение в столбце `amount`.

### `MAX()` — Находит максимальное значение

**Синтаксис:**
```sql
MAX(expression)
```

**Пример:**
```sql
SELECT MAX(amount) AS max_amount
FROM payment;
```
**Результат:** Возвращает наибольшее значение в столбце `amount`.

## Практическое применение

1. **Подсчет количества клиентов:**
   Используйте `COUNT(customer_id)`, чтобы узнать, сколько клиентов в базе данных.
   ```sql
   SELECT COUNT(customer_id) AS total_customers
   FROM customer;
   ```
2. **Вычисление общей суммы продаж по сотрудникам:**
   Используйте `SUM(amount)` с `GROUP BY staff_id`, чтобы увидеть продажи по каждому сотруднику.
   ```sql
   SELECT staff_id, SUM(amount) AS staff_total
   FROM payment
   GROUP BY staff_id;
   ```
3. **Нахождение среднего платежа по клиенту:**
   Используйте `AVG(amount)` с `GROUP BY customer_id`.
   ```sql
   SELECT customer_id, AVG(amount) AS avg_payment
   FROM payment
   GROUP BY customer_id;
   ```

## Основные выводы из этого урока

Агрегатные функции SQL — мощный инструмент для анализа и обобщения данных. Освоив `COUNT`, `SUM`, `AVG`, `MIN` и `MAX`, вы сможете создавать информативные отчеты и получать ценные инсайты из вашей базы данных. Практикуйтесь с этими функциями на примерах из базы Sakila для закрепления навыков.
